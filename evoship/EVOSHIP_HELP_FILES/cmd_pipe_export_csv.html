<!DOCTYPE html>
<html lang="ja">
<head>
  <meta name="GENERATOR" content="HelpMachine 2.4.9" />
  <meta http-equiv="content-type" content="text/html; charset=Shift_JIS" />
  <link href="basic.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="script/util.js"></script>
  <title>配管系統出力</title>
</head>
<body>
<div class="page">
  <h2>配管系統出力</h2>
  <div class="contents">
  <p>接続されている配管のルート点と属性情報を、それぞれ系統単位でCSV形式のテキストファイルに出力します。</p>
  <h3>操作方法</h3>
  <p>コマンドを実行するとファイル選択ダイアログが表示されるので、出力先テキストファイルの名前を指定します。続いて出力対象となる配管要素を指定します。OKをクリックするとテキストファイルが作成されます。</p>
  <h3>パラメータ</h3>
  <h4>出力ファイル</h4>
  <img src="media/dlg_pipe_export_csv_file.png" />
  <p>出力先ファイル名を指定します。ただしファイル名はそのまま使われるのではなく、接尾辞を付加した名称でファイルが2つ作成されます（後述）。</p>
  <h4>出力対象要素</h4>
  <img src="media/dlg_pipe_export_csv_sel_methods.png" />
  <p>出力対象となる要素を指定します。「選択されている要素」を選ぶと選択リストボックスが表示され、ドキュメントウィンドウ内で要素を選択できます。</p>
  <h3>出力結果</h3>
  <p>ルート点情報と属性情報はそれぞれ</p>
  <ul>
    <li>[指定したファイル名]_routes.csv</li>
    <li>[指定したファイル名]_attributes.csv</li>
  </ul>
  <p>というファイルに出力されます。</p>
  <h4>ルート点情報ファイル</h4>
  <p>ルート点情報ファイルは</p>
  <ol>
    <li>group,[系統名（要素グループ名）1]</li>
    <li>route</li>
    <li>[ルート点1]</li>
    <li>[ルート点2]</li>
    <li>group,[系統名（要素グループ名）2]</li>
    <li>route</li>
    <li>[ルート点3]</li>
    <li>[ルート点4]</li>
    <li>[ルート点5]</li>
    <li>...</li>
  </ol>
  <p>という形式で出力されます。ルート点行の各列の内容は</p>
  <blockquote>点ID, X座標値(mm), Y座標値(mm), Z座標値(mm), 点の内部ID</blockquote>
  <p>となります。</p>
  <h4>属性情報ファイル</h4>
  <p>属性情報ファイルは、ヘッダー行に続いて以下の各列の内容が1要素1行で出力されます。</p>
  <table>
  <tr><th>GROUP</th><td>区画名（「要素グループ/配管設計/区画」配下の要素グループ名）</td></tr>
  <tr><th>PIPESET</th><td>系統名（「要素グループ/配管設計/系統」配管の配管セット名）</td></tr>
  <tr><th>NAME</th><td>要素名</td></tr>
  <tr><th>TYPE</th><td>要素の種類</td></tr>
  <tr><th>LENGTH</th><td>長さ（工作長）</td></tr>
  <tr><th>ANGLE</th><td>曲げ角度</td></tr>
  <tr><th>MAIN/BRANCH</th><td>本管/枝管</td></tr>
  <tr><th>STD PART</th><td>標準部品名称</td></tr>
  <tr><th>WEIGHT</th><td>重量</td></tr>
  <tr><th>COG_X</th><td>重心X座標</td></tr>
  <tr><th>COG_Y</th><td>重心Y座標</td></tr>
  <tr><th>COG_Z</th><td>重心Z座標</td></tr>
  <tr><th>NOMINAL_1</th><td>呼び径</td></tr>
  <tr><th>NOMINAL_2</th><td>呼び径2（レジューサ、異径ティー）</td></tr>
  <tr><th>PARAM_1〜15</th><td>要素の種類ごとに異なる属性</td></tr>
  <tr><th>ID</th><td>内部ID</td></tr>
  <tr><th>ATTR_*</th><td>装置区分、系統番号など、個々の配管要素に割り当てられた配管属性</td></tr>
  </table>
  <p>PARAM1〜15の内容は以下の通りです。</p>
  <dl>
  <dt>straight - パイプ</dt>
  <dd>開始点ID, 終了点ID</dd>
  <dt>elbow - エルボ</dt>
  <dd>基準点ID, 曲げ設定名, 曲げ半径(mm), 角度(deg)</dd>
  <dt>std elbow - 部品エルボ</dt>
  <dd>基準点ID, 追加点ID, 部品パラメータ(*1)</dd>
  <dt>flange - フランジ</dt>
  <dd>基準点ID, ライニング（あり＝「LINING」）, 部品パラメータ(*1)</dd>
  <dt>sleeve - スリーブ</dt>
  <dd>基準点ID, 中継/貫通/化粧（＝RELAY/THRU/DECO）,長スリーブ（該当＝「LONG」）,スリーブ長(*2), 始点側突込み量(*2), 終点側突込み量(*2), 特殊取り付け（該当＝「SPECIAL」）, 部品パラメータ(*1) 《*2 は長スリーブのみ出力》</dd>
  <dt>socket - ソケット</dt>
  <dd>基準点ID, 逆向き（該当＝「REVERSE」）, 部品パラメータ(*1)
  <dt>reducer - レジューサ</dt>
  <dd>開始点ID, 終了点ID, 部品パラメータ(*1)</dd>
  <dt>tee - ティー</dt>
  <dd>基準点ID, 部品パラメータ(*1)</dd>
  <dt>branch - 溶接枝点</dt>
  <dd>基準点ID, 突っ込み量(mm)</dd>
  <dt>component - コンポーネント</dt>
  <dd>接続点ID（この系統に使われている点IDが列挙されます）</dd>
  <dt>equipment - 配管機器</dt>
  <dd>接続点ID（この系統に使われている点IDが列挙されます）</dd>
  </dl>
  <p>《*1 部品パラメータは設定ファイルEvShipPipeStandard.csvの該当するパラメータのうち、呼び径より後のパラメータが出力されます》</p>
  </div>
</div>
</body>
</html>
