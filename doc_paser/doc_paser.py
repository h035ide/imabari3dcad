from langchain_core.output_parsers import JsonOutputParser
from langchain_core.prompts import ChatPromptTemplate
from langchain_openai import ChatOpenAI
from dotenv import load_dotenv
import json
import os
import sys

load_dotenv()

def read_file_safely(file_path, encoding="utf-8"):
    """
    ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®‰å…¨ã«èª­ã¿è¾¼ã‚€å…±é€šé–¢æ•°
    Args:
        file_path (str): èª­ã¿è¾¼ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
        encoding (str): ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: utf-8ï¼‰
    Returns:
        str: ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹
    Raises:
        FileNotFoundError: æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
        UnicodeDecodeError: ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒä¸æ­£ãªå ´åˆ
        IOError: ãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
    """
    try:
        with open(file_path, "r", encoding=encoding) as file:
            return file.read()
    except FileNotFoundError:
        raise FileNotFoundError(f"ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {file_path}")
    except UnicodeDecodeError:
        raise UnicodeDecodeError(f"ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒä¸æ­£ã§ã™: {file_path}")
    except IOError as e:
        raise IOError(f"ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {file_path} - {str(e)}")

def load_api_document(file_path=None):
    """
    APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’èª­ã¿è¾¼ã‚€é–¢æ•°
    
    Args:
        file_path (str, optional): ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ã€‚Noneã®å ´åˆã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¿”ã™
        
    Returns:
        str: APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®å†…å®¹
        
    Raises:
        FileNotFoundError: æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
        UnicodeDecodeError: ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒä¸æ­£ãªå ´åˆ
        IOError: ãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
    """

    if file_path is None:
        # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆapi 1.txtã®å†…å®¹ï¼‰
        DEFAULT_API_DOC = """â– é–¢æ•°ã®ä»•æ§˜ï¼ˆå¼•æ•°ã®å‹ã€æ›¸å¼ã¯api_argã‚’å‚ç…§ï¼‰

â– Partã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚½ãƒƒãƒ‰

ã€‡å¤‰æ•°è¦ç´ ã®ä½œæˆ
ã€€è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸå¤‰æ•°è¦ç´ ã®è¦ç´ ID
ã€€CreateVariable
        VariableName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹å¤‰æ•°åç§°ï¼ˆç©ºæ–‡å­—ä¸å¯ï¼‰
        VariableValue,// æµ®å‹•å°æ•°ç‚¹: å¤‰æ•°ã®å€¤
        VariableUnit  // å¤‰æ•°å˜ä½ï¼šä½œæˆã™ã‚‹å¤‰æ•°ã®å˜ä½ã‚’æŒ‡å®š
        VariableElementGroup );// è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹å¤‰æ•°è¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰

ã€‡ã‚¹ã‚±ãƒƒãƒå¹³é¢ã®ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒå¹³é¢è¦ç´ ã®è¦ç´ ID
  CreateSketchPlane(
        ElementName,  // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒå¹³é¢åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ElementGroup, // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒå¹³é¢ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        PlaneDef, ã€€ã€€// å¹³é¢ï¼šã‚¹ã‚±ãƒƒãƒå¹³é¢ã‚’ä½œæˆã™ã‚‹å¹³é¢ã‚’æŒ‡å®šã™ã‚‹
        PlaneOffset,  // é•·ã•ï¼šå¹³é¢ã‹ã‚‰ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢ã‚’æŒ‡å®š
        bRevPlane,    // bool:ã‚¹ã‚±ãƒƒãƒå¹³é¢ã‚’åè»¢ã™ã‚‹ã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°(bool)
        bRevUV,       // bool:ã‚¹ã‚±ãƒƒãƒå¹³é¢ã®X,Yè»¸ã‚’äº¤æ›ã™ã‚‹ã‹ã©ã†ã‹ã®ãƒ•ãƒ©ã‚°(bool)
        è¬            // boolï¼š
        StyleName,    // æ³¨è¨˜ã‚¹ã‚¿ã‚¤ãƒ«:ã€€ã‚¹ã‚±ãƒƒãƒå¹³é¢ã«é©ç”¨ã™ã‚‹æ³¨è¨˜ã‚¹ã‚¿ã‚¤ãƒ«åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        OriginPoint,  // ç‚¹ï¼šã‚¹ã‚±ãƒƒãƒå¹³é¢ã®åŸç‚¹ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        AxisDirection,// æ–¹å‘ï¼šã‚¹ã‚±ãƒƒãƒå¹³é¢ã®è»¸æ–¹å‘ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        bDefAxisIsX,  // boolï¼šã‚¹ã‚±ãƒƒãƒå¹³é¢ã®Xå®Ÿã‚’æŒ‡å®šã™ã‚‹å ´åˆã¯True(bool)
        bUpdate );    // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼è¦ç´ ã®è¦ç´ ID
  CreateSketchLayer(
        SketchLayerName,  // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchPlane );ã€€ã€€// è¦ç´ ï¼šãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 

ã€‡ã‚¹ã‚±ãƒƒãƒç›´ç·šä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒç›´ç·šè¦ç´ ã®è¦ç´ ID
  CreateSketchLine(
        SketchPlane,   // è¦ç´ ï¼šç›´ç·šã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 
        SketchLineName,// æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒç›´ç·šåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchLayer,   // è¦ç´ ï¼šç›´ç·šã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼(ç©ºæ–‡å­—å¯ï¼‰
        StartPoint,    // ç‚¹(2D)ï¼šå§‹ç‚¹
        EndPoint,      // ç‚¹(2D)ï¼šçµ‚ç‚¹
        bUpdate );     // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ã‚¹ã‚±ãƒƒãƒå††å¼§ã‚’ä¸­å¿ƒç‚¹ã¨å§‹çµ‚ç‚¹ã‚’æŒ‡å®šã—ã¦ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒå††å¼§è¦ç´ ã®è¦ç´ ID
  CreateSketchArc(
        SketchPlane,   // è¦ç´ ï¼šå††å¼§ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 
        SketchArcName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒå††å¼§åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchLayer,   // è¦ç´ ï¼šå††å¼§ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼(ç©ºæ–‡å­—å¯ï¼‰
        CenterPoint,   // ç‚¹(2D)ï¼šä¸­å¿ƒç‚¹
        StartPoint,    // ç‚¹(2D)ï¼šå§‹ç‚¹
        EndPoint,      // ç‚¹(2D)ï¼šçµ‚ç‚¹
        bCCW,          // boolï¼š å††å¼§ã®å›è»¢æ–¹å‘Trueã®å ´åˆã¯åæ™‚è¨ˆå‘¨ã‚Š
        bUpdate );     // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ã‚¹ã‚±ãƒƒãƒå††å¼§ã‚’å‘¨ä¸Šã®ï¼“ç‚¹ã‚’æŒ‡å®šã—ã¦ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒå††å¼§è¦ç´ ã®è¦ç´ ID
  CreateSketchArc3Pts(
        SketchPlane,   // è¦ç´ ï¼šå††å¼§ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 
        SketchArcName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒå††å¼§åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchLayer,   // è¦ç´ ï¼šå††å¼§ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼(ç©ºæ–‡å­—å¯ï¼‰
        StartPoint,    // ç‚¹(2D)ï¼šå§‹ç‚¹
        MidPoint,      // ç‚¹(2D)ï¼šé€šéç‚¹
        EndPoint,      // ç‚¹(2D)ï¼šçµ‚ç‚¹
        bUpdate );     // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰
 
ã€‡ã‚¹ã‚±ãƒƒãƒå††ã‚’ä¸­å¿ƒç‚¹ã‚’æŒ‡å®šã—ã¦ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒå††è¦ç´ ã®è¦ç´ ID
  CreateSketchCircle(
        SketchPlane,   // è¦ç´ ï¼šå††ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 
        SketchArcName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒå††åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchLayer,   // è¦ç´ ï¼šå††ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼(ç©ºæ–‡å­—å¯ï¼‰
        Centeroint,    // ç‚¹(2D)ï¼šä¸­å¿ƒç‚¹
        RadiusOrDiameter, // é•·ã•ï¼šåŠå¾„ã¾ãŸã¯ç›´å¾„
        bDiameter,     // boolï¼šç›´å¾„ã‚’æŒ‡å®šã™ã‚‹å ´åˆã¯True
        bCCW,          // boolï¼šå††ã®å›è»¢æ–¹å‘Trueã®å ´åˆã¯åæ™‚è¨ˆå‘¨ã‚Š
        bUpdate );     // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ã‚¹ã‚±ãƒƒãƒæ¥•å††ã‚’ä¸­å¿ƒç‚¹ã‚’æŒ‡å®šã—ã¦ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒæ¥•å††è¦ç´ ã®è¦ç´ ID
  CreateSketchEllipse(
        SketchPlane,   // è¦ç´ ï¼šæ¥•å††ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 
        SketchArcName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒæ¥•å††åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchLayer,   // è¦ç´ ï¼šæ¥•å††ã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼(ç©ºæ–‡å­—å¯ï¼‰
        Centeroint,    // ç‚¹(2D)ï¼šä¸­å¿ƒç‚¹
        bCCW,          // boolï¼šæ¥•å††ã®å›è»¢æ–¹å‘Trueã®å ´åˆã¯åæ™‚è¨ˆå‘¨ã‚Š
        MajorDir,ã€€ã€€ã€€// æ–¹å‘(2D)ï¼šä¸»è»¸æ–¹å‘ã‚’æŒ‡å®š
        MajorRadius,   // é•·ã•ï¼šä¸»è»¸åŠå¾„
        MinorRadius,   // é•·ã•ï¼šå‰¯è»¸åŠå¾„
        Range,         // ç¯„å›²: (0-2pi)
        bUpdate );     // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ã‚¹ã‚±ãƒƒãƒï¼®ï¼µï¼²ï¼¢ï¼³ç·šã‚’ä¸­å¿ƒç‚¹ã‚’æŒ‡å®šã—ã¦ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚¹ã‚±ãƒƒãƒï¼®ï¼µï¼²ï¼¢ï¼³ç·šè¦ç´ ã®è¦ç´ ID
  CreateSketchNURBSCurve(
        SketchPlane,   // è¦ç´ ï¼šï¼®ï¼µï¼²ï¼¢ï¼³ç·šã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒè¦ç´ 
        SketchArcName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒï¼®ï¼µï¼²ï¼¢ï¼³ç·šåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SketchLayer,   // è¦ç´ ï¼šï¼®ï¼µï¼²ï¼¢ï¼³ç·šã‚’ä½œæˆã™ã‚‹ã‚¹ã‚±ãƒƒãƒãƒ¬ã‚¤ãƒ¤ãƒ¼(ç©ºæ–‡å­—å¯ï¼‰
        nDegree,       // æ•´æ•°ï¼šï¼®ï¼µï¼²ï¼¢ï¼³ç·šã®æ¬¡æ•°
        bClose,        // boolï¼šé–‰ã˜ãŸï¼®ï¼µï¼²ï¼¢ï¼³ç·šã®å ´åˆTrue
        bPeriodic,     // boolï¼šå‘¨æœŸï¼®ï¼µï¼²ï¼¢ï¼³ç·šã®å ´åˆTrue
        CtrlPoints,    // ç‚¹(é…åˆ—): åˆ¶å¾¡ç‚¹
        Weights,       // æµ®å‹•å°æ•°ç‚¹(é…åˆ—): é‡ã¿
        Knots,         // æµ®å‹•å°æ•°ç‚¹(é…åˆ—): ãƒãƒƒãƒˆãƒ™ã‚¯ãƒˆãƒ«
        Range,         // ç¯„å›²: ãƒˆãƒªãƒ ç¯„å›²
        bUpdate );     // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦è¦ç´ ã‚’ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸè¦ç´ ã®è¦ç´ IDã®é…åˆ—
  CreateElementsFromFile(
        FileName,      // æ–‡å­—åˆ—:ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹ï¼ˆç¾çŠ¶ã€Parasolidå½¢å¼ã®ã¿ï¼‰
       );

ã€‡ã‚ªãƒ•ã‚»ãƒƒãƒˆã‚·ãƒ¼ãƒˆã‚’ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚ªãƒ•ã‚»ãƒƒãƒˆã‚·ãƒ¼ãƒˆè¦ç´ ã®è¦ç´ ID
  CreateOffsetSheet(
        SheetName,    // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚·ãƒ¼ãƒˆè¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ElementGroup, // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚·ãƒ¼ãƒˆè¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        MaterialName, // ææ–™ï¼šä½œæˆã™ã‚‹ã‚·ãƒ¼ãƒˆè¦ç´ ã®æè³ªåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        SrcSurfaces,  // è¦ç´ (é…åˆ—):ã‚ªãƒ•ã‚»ãƒƒãƒˆã™ã‚‹å…ƒã‚·ãƒ¼ãƒˆè¦ç´ ã€ãƒ•ã‚§ã‚¤ã‚¹è¦ç´ ã®æŒ‡å®šæ–‡å­—åˆ—é…åˆ—
        OffsetLength, // é•·ã•ï¼šã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
        bOffsetBackwards, // boolï¼š ã‚ªãƒ•ã‚»ãƒƒãƒˆæ–¹å‘ã‚’åè»¢
        bUpdate,ã€€//boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰
    ); 

ã€‡æŠ¼ã—å‡ºã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
ã€€è¿”ã‚Šå€¤:æŠ¼ã—å‡ºã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
ã€€CreateLinearSweepParam()ã€€

ã€‡æŠ¼ã—å‡ºã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
   å±æ€§
   NAME   // æ–‡å­—åˆ—ï¼šè¦ç´ åï¼ˆç©ºæ–‡å­—å¯ï¼‰
   ElementGroup, // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚·ãƒ¼ãƒˆè¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
   Target1  // è¦ç´ (é…åˆ—)ï¼šã‚¹ã‚¤ãƒ¼ãƒ—ã™ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦ç´ ï¼‘ã€€ï¼ˆç‚¹ã€ç·šã€ã‚·ãƒ¼ãƒˆã€ã‚½ãƒªãƒƒãƒ‰ã€ã‚ã‚‹ã„ã¯ã‚½ãƒªãƒƒãƒ‰ãƒ•ã‚§ã‚¤ã‚¹ï¼‰
   Target2  // è¦ç´ (é…åˆ—)ï¼šã‚¹ã‚¤ãƒ¼ãƒ—æ–¹å‘ãŒï¼’æ–¹å‘ã®å ´åˆã«ä½¿ç”¨ã€‚ã‚¹ã‚¤ãƒ¼ãƒ—ã™ã‚‹ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè¦ç´ ï¼’
   ProfileNormal // æ–¹å‘ï¼šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®å¹³é¢æ³•ç·šæ–¹å‘ã€‚ï¼ˆãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ãŒï¼“Dã®ç›´ç·šã®å ´åˆã«ãã®å¹³é¢æ³•ç·šã¨ã—ã¦æŒ‡å®šã€‚ï¼‰ 
   ProfileOffset // é•·ã•ï¼šãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ä½ç½®ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
   DirectionType  // ã‚¹ã‚¤ãƒ¼ãƒ—æ–¹å‘ï¼š 
   DirectionParameter1 // é•·ã•ï¼š ã‚¹ã‚¤ãƒ¼ãƒ—ã™ã‚‹è·é›¢ï¼‘ï¼ˆSweepTarget1ã‚’æŒ‡å®šã—ã¦ã„ã‚‹å ´åˆã¯ä½¿ç”¨ã—ãªã„ï¼‰
   DirectionParameter2 // é•·ã•ï¼š ã‚¹ã‚¤ãƒ¼ãƒ—æ–¹å‘ãŒï¼’æ–¹å‘ã®å ´åˆã«ä½¿ç”¨ã€‚ã‚¹ã‚¤ãƒ¼ãƒ—ã™ã‚‹è·é›¢ï¼’ï¼ˆSweepTargetï¼’ã‚’æŒ‡å®šã—ã¦ã„ã‚‹å ´åˆã¯ä½¿ç”¨ã—ãªã„ï¼‰
   SweepDirection // æ–¹å‘ï¼šã‚¹ã‚¤ãƒ¼ãƒ—ã™ã‚‹æ–¹å‘ã‚’è¨­å®šã™ã‚‹å ´åˆã«ä½¿ç”¨ã€‚æŒ‡å®šã—ãªã„å ´åˆã¯ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã®æ³•ç·šæ–¹å‘
   DraftAngle   // è§’åº¦: æŠ¼ã—å‡ºã—æ–¹å‘ã®å‹¾é…è§’åº¦
   DraftAngle2Typeã€€// å‹¾é…ï¼’ã®ã‚¿ã‚¤ãƒ—: ï¼’æ–¹å‘ã«æŠ¼ã—å‡ºã™éš›ã®å‹¾é…ã®å–ã‚Šæ–¹æŒ‡å®š
   DraftAngle2ã€€// è§’åº¦: ï¼’æ–¹å‘ç›®ã®æŠ¼ã—å‡ºã—æ–¹å‘ã®å‹¾é…è§’åº¦
   ThickenTypeã€€// åšã¿ä»˜ã‘ã‚¿ã‚¤ãƒ—: 
   Thickeness1  // é•·ã•ï¼š æ¿åš
   Thickeness2  // é•·ã•ï¼š æ¿åšï¼’ï¼ˆåšã¿ä»˜ã‘ã‚¿ã‚¤ãƒ—ãŒï¼’æ–¹å‘ã®ã¨ãã«ä½¿ç”¨ï¼‰
   ThickenessOffset // é•·ã•ï¼š åšã¿ã¥ã‘ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
   bRefByGeometricMethod // boolï¼šTrueã®æ™‚ã¯å¹¾ä½•ä½ç½®ã«ã‚‚ã¨ã¥ã„ã¦é–¢é€£ã‚’è¨­å®šã™ã‚‹
   bIntervalSwep // boolï¼š
   ReferMethod // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š

ã€‡ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«è¦ç´ ã‚’æŠ¼ã—å‡ºã—ã¦ã‚·ãƒ¼ãƒˆè¦ç´ ã‚’ä½œæˆ
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚·ãƒ¼ãƒˆè¦ç´ ã®è¦ç´ ID
  CreateLinearSweepSheet(
        ParamObj, // æŠ¼ã—å‡ºã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        bUpdate);ã€€// boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ã‚·ãƒ¼ãƒˆè¦ç´ ã®å‘ãï¼ˆè¡¨å´ã€æ³•ç·šæ–¹å‘ï¼‰ã‚’æŒ‡å®šã—ãŸæ–¹å‘ã«æƒãˆã‚‹
  è¿”ã‚Šå€¤:ãªã—
  SheetAlignNormal(
        SheetElement,// è¦ç´ ï¼šæ–¹å‘ã‚’æƒãˆã‚‹ã‚·ãƒ¼ãƒˆè¦ç´ 
        dirX,   // æµ®å‹•å°æ•°ç‚¹: æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã®Xæˆåˆ†
        dirY,   // æµ®å‹•å°æ•°ç‚¹: æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã®Yæˆåˆ†
        dirZ ); // æµ®å‹•å°æ•°ç‚¹: æ–¹å‘ãƒ™ã‚¯ãƒˆãƒ«ã®Zæˆåˆ†

ã€‡ã‚·ãƒ¼ãƒˆè¦ç´ ã®å‘ãã‚’åè»¢ã™ã‚‹
  è¿”ã‚Šå€¤:ã‚·ãƒ¼ãƒˆåè»¢ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®è¦ç´ ID
  ReverseSheet(
        SheetElement ); // è¦ç´ ï¼šåè»¢ã™ã‚‹ã‚·ãƒ¼ãƒˆè¦ç´ 

ã€‡æŒ‡å®šè¦ç´ ã‚’è¡¨ç¤ºçŠ¶æ…‹ã‚’è¨­å®šã™ã‚‹
  è¿”ã‚Šå€¤:ãªã—
  BlankElement(
        Element,  // è¦ç´ ï¼šè¡¨ç¤ºçŠ¶æ…‹ã‚’æŒ‡å®šã™ã‚‹è¦ç´ 
        bBlank ); // boolï¼š Trueã®æ™‚ã¯éè¡¨ç¤ºã«ã™ã‚‹ã€‚Falseã®æ™‚ã¯è¡¨ç¤ºã™ã‚‹ã€‚

ã€‡æŒ‡å®šè¦ç´ ã‚’ç§»å‹•ã‚³ãƒ”ãƒ¼ã™ã‚‹
  è¿”ã‚Šå€¤:ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸè¦ç´ IDé…åˆ—
  TranslationCopy(
        SrcElements,// è¦ç´ (é…åˆ—)ï¼šã‚³ãƒ”ãƒ¼ã™ã‚‹è¦ç´ 
        nCopy,    // æ•´æ•°: ã‚³ãƒ”ãƒ¼ã™ã‚‹æ•°
        direction,      // æ–¹å‘ï¼šã‚³ãƒ”ãƒ¼ã™ã‚‹æ–¹å‘
        distance,       // é•·ã•ï¼šç§»å‹•è·é›¢
        ReferMethod);  // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š

ã€‡æŒ‡å®šè¦ç´ ã‚’ãƒŸãƒ©ãƒ¼ã‚³ãƒ”ãƒ¼ã™ã‚‹
  è¿”ã‚Šå€¤:ã‚³ãƒ”ãƒ¼ã•ã‚ŒãŸè¦ç´ IDé…åˆ—
  MirrorCopy(
        SrcElements,// è¦ç´ (é…åˆ—)ï¼šã‚³ãƒ”ãƒ¼ã™ã‚‹è¦ç´ 
        [in] BSTR plane,
        ReferMethod);  // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š

ã€‡ç©ºã®ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’ä½œæˆã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸã‚½ãƒªãƒƒãƒ‰ã®è¦ç´ ID
  CreateSolid(
        SolidName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ElementGroup, // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        MaterialName ) // ææ–™ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®æè³ªåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰

ã€‡æŒ‡å®šã—ãŸã‚½ãƒªãƒƒãƒ‰è¦ç´ ã«æŒ‡å®šè¦ç´ åšã¿ã¥ã‘ã—ãŸå½¢çŠ¶ã‚’ä½œæˆã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸåšã¿ã¥ã‘ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®ID
  CreateThicken(
        ThickenFeatureName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹åšã¿ã¥ã‘ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        TargetSolidName,    // è¦ç´ ï¼šåšã¿ã¥ã‘ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚’ä½œæˆã™ã‚‹å¯¾è±¡ã®ã‚½ãƒªãƒƒãƒ‰ã‚’æŒ‡å®š
        OperationType,      // ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—: ã‚½ãƒªãƒƒãƒ‰ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®šã™ã‚‹
ã€€ã€€ã€€ã€€Sheet,ã€€ã€€ã€€ã€€ã€€ã€€ã€€// è¦ç´ (é…åˆ—)ï¼šåšã¿ä»˜ã‘ã‚’ã™ã‚‹ã‚·ãƒ¼ãƒˆã‚„ãƒ•ã‚§ã‚¤ã‚¹
        ThickenType,ã€€ã€€ã€€ã€€// åšã¿ä»˜ã‘ã‚¿ã‚¤ãƒ—: 
        Thickeness1,        // é•·ã•ï¼š æ¿åš
        Thickeness2,ã€€ã€€ã€€ã€€// é•·ã•ï¼š æ¿åšï¼’ï¼ˆåšã¿ä»˜ã‘ã‚¿ã‚¤ãƒ—ãŒï¼’æ–¹å‘ã®ã¨ãã«ä½¿ç”¨ï¼‰
        ThickenessOffset,   // é•·ã•ï¼š åšã¿ã¥ã‘ã‚’ã™ã‚‹ã‚·ãƒ¼ãƒˆã€ãƒ•ã‚§ã‚¤ã‚¹è¦ç´ ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
        ReferMethod,ã€€ã€€ã€€ã€€// é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š
        bUpdate);ã€€// boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡æŒ‡å®šã—ãŸã‚½ãƒªãƒƒãƒ‰è¦ç´ ã«åˆ¥ã®ã‚½ãƒªãƒƒãƒ‰è¦ç´ å½¢çŠ¶ã‚’ä»˜åŠ ã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸåˆ¥ã‚½ãƒªãƒƒãƒ‰ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®ID
  CreateOtherSolid(
ã€€ã€€ã€€ã€€OtherSolidFeatureName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹åˆ¥ã‚½ãƒªãƒƒãƒ‰ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        TargetSolidName,  // è¦ç´ ï¼šåˆ¥ã‚½ãƒªãƒƒãƒ‰ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚’ä½œæˆã™ã‚‹å¯¾è±¡ã®ã‚½ãƒªãƒƒãƒ‰ã‚’æŒ‡å®š
        OperationType,  // ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—: ã‚½ãƒªãƒƒãƒ‰ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®šã™ã‚‹
        SourceSolid,    // è¦ç´ ï¼šåˆ¥ã‚½ãƒªãƒƒãƒ‰ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã¨ã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’æŒ‡å®šã™ã‚‹
        ReferMethod, // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š
        bUpdateã€€);ã€€// boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡æŒ‡å®šã—ãŸã‚½ãƒªãƒƒãƒ‰è¦ç´ ã«æŠ¼ã—å‡ºã—å½¢çŠ¶ã‚’ä»˜åŠ ã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã•ã‚ŒãŸæŠ¼ã—å‡ºã—ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã®ID
  CreateLinearSweep(
        TargetSolidName,         // è¦ç´ ï¼šæŠ¼ã—å‡ºã—ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼ã‚’ä½œæˆã™ã‚‹å¯¾è±¡ã®ã‚½ãƒªãƒƒãƒ‰ã‚’æŒ‡å®š
        OperationType,   // ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—: ã‚½ãƒªãƒƒãƒ‰ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®šã™ã‚‹
        pParam, // æŠ¼ã—å‡ºã—ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        bUpdate ã€€);ã€€// boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡èˆ¹æ®»ã®ãƒ–ãƒ©ã‚±ãƒƒãƒˆè¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
ã€€è¿”ã‚Šå€¤:ãƒ–ãƒ©ã‚±ãƒƒãƒˆè¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
ã€€CreateBracketParam()
ã€€ã€€
ã€‡ãƒ–ãƒ©ã‚±ãƒƒãƒˆè¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
   å±æ€§
        DefinitionType //ã€€æ•´æ•°: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®ä½œæˆæ–¹æ³•æŒ‡å®šã€€0: é¢æŒ‡å®šã€€1:åŸºæº–è¦ç´ æŒ‡å®š
        BracketName // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ãƒ–ãƒ©ã‚±ãƒƒãƒˆã‚½ãƒªãƒƒãƒ‰è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ElementGroup // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        MaterialName // ææ–™ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®æè³ªåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        BasePlane    //é¢æŒ‡å®šã®å ´åˆã®åŸºæº–å¹³é¢
        BasePlaneOffset // é•·ã•ï¼šåŸºæº–å¹³é¢ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
        BaseElement  // åŸºæº–è¦ç´ æŒ‡å®šã®å ´åˆã®åŸºæº–è¦ç´ 
        UseSideSheetForPlane // boolï¼š ä¸‰é¢æŒ‡å®šã®å ´åˆã¯True
        Thickness // é•·ã•ï¼š æ¿åš
        Mold     // ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®: 
        MoldOffset // é•·ã•ï¼š ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
        BracketType // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—
        BracketParams,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        Scallop1Type,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—
        Scallop1Params,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        nScallop2Type,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ï¼“é¢ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®å ´åˆã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ï¼’ã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—
        Scallop2Params,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ï¼’ã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        Surfaces1, // è¦ç´ (é…åˆ—)ï¼šãƒ–ãƒ©ã‚±ãƒƒãƒˆä½œæˆã™ã‚‹é¢ï¼‘ã®è¦ç´ ï¼ˆã‚½ãƒªãƒƒãƒ‰ã€ã‚·ãƒ¼ãƒˆã€ãƒ•ã‚§ã‚¤ã‚¹ï¼‰
        RevSf1, // boolï¼š é¢ï¼‘ã®åå¯¾å´ã«ãƒ–ãƒ©ã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆã¯True
        Surfaces2, // è¦ç´ (é…åˆ—)ï¼šãƒ–ãƒ©ã‚±ãƒƒãƒˆä½œæˆã™ã‚‹é¢2ã®è¦ç´ ï¼ˆã‚½ãƒªãƒƒãƒ‰ã€ã‚·ãƒ¼ãƒˆã€ãƒ•ã‚§ã‚¤ã‚¹ï¼‰
        RevSf2, // boolï¼š é¢2ã®åå¯¾å´ã«ãƒ–ãƒ©ã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆã¯True
        Surfaces3, // è¦ç´ (é…åˆ—)ï¼šï¼“é¢ãƒ–ãƒ©ã‚±ãƒƒãƒˆä½œæˆã™ã‚‹å ´åˆã®é¢ï¼“ã®è¦ç´ ï¼ˆã‚½ãƒªãƒƒãƒ‰ã€ã‚·ãƒ¼ãƒˆã€ãƒ•ã‚§ã‚¤ã‚¹ï¼‰
        RevSf3, // boolï¼š é¢3ã®åå¯¾å´ã«ãƒ–ãƒ©ã‚±ãƒƒãƒˆã‚’ä½œæˆã™ã‚‹å ´åˆã¯True
        FlangeType, // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®ãƒ•ãƒ©ãƒ³ã‚¸ã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã€€(0ã®å ´åˆã¯ãƒ•ãƒ©ãƒ³ã‚¸ã‚’ã¤ã‘ãªã„ï¼‰
        FlangeParams,// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ãƒ–ãƒ©ã‚±ãƒƒãƒˆã®ãƒ•ãƒ©ãƒ³ã‚¸ã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        RevFlange,ã€€// boolï¼š ãƒ•ãƒ©ãƒ³ã‚¸ã®å‘ãã‚’åè»¢ã™ã‚‹å ´åˆã¯True
        FlangeAngle, // è§’åº¦ï¼š ãƒ•ãƒ©ãƒ³ã‚¸ã®è§’åº¦æŒ‡å®šã€€ï¼Â°ã¯ç›´è§’ã‚’æ„å‘³ã—ã€ãã“ã‹ã‚‰ã®å¢—åˆ†ã‚’ï¼‹ï¼ã§æŒ‡å®š
        Sf1DimensionType,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: é¢ï¼‘æ–¹å‘ã®å¯¸æ³•ã‚¿ã‚¤ãƒ—
        Sf1DimensonParams,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: é¢ï¼‘æ–¹å‘ã®å¯¸æ³•ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        Sf1EndElements, // è¦ç´ (é…åˆ—)ï¼šé¢ï¼‘æ–¹å‘ã®ç«¯éƒ¨è¦ç´ ï¼ˆå¿…è¦ãªå½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®å ´åˆï¼‰
        Sf1BaseElements,ã€€// è¦ç´ (é…åˆ—)ï¼šé¢ï¼‘æ–¹å‘ã®åŸºæº–è¦ç´ ï¼ˆå¿…è¦ãªå½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®å ´åˆï¼‰
        Sf2DimensionType,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: é¢ï¼’æ–¹å‘ã®å¯¸æ³•ã‚¿ã‚¤ãƒ—
        Sf2DimensonParams,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: é¢ï¼’æ–¹å‘ã®å¯¸æ³•ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        Sf2EndElements,ã€€// è¦ç´ (é…åˆ—)ï¼šé¢ï¼’æ–¹å‘ã®ç«¯éƒ¨è¦ç´ ï¼ˆå¿…è¦ãªå½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®å ´åˆï¼‰
        Sf2BaseElements,ã€€// è¦ç´ (é…åˆ—)ï¼šé¢ï¼’æ–¹å‘ã®åŸºæº–è¦ç´ ï¼ˆå¿…è¦ãªå½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®å ´åˆï¼‰
        ScallopEnd1LowerType,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: é¢ï¼‘æ–¹å‘ã®ä¸‹å´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—
        ScallopEnd1LowerParams,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: é¢ï¼‘æ–¹å‘ã®ä¸‹å´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        ScallopEnd1UpperType,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: é¢ï¼‘æ–¹å‘ã®ä¸Šå´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—
        ScallopEnd1UpperParams,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: é¢ï¼‘æ–¹å‘ã®ä¸Šå´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        ScallopEnd2LowerType,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: é¢ï¼’æ–¹å‘ã®ä¸‹å´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—
        ScallopEnd2LowerParams,ã€€// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: é¢ï¼’æ–¹å‘ã®ä¸‹å´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        ScallopEnd2UpperType,ã€€// å½¢çŠ¶ã‚¿ã‚¤ãƒ—: é¢ï¼’æ–¹å‘ã®ä¸Šå´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—
        ScallopEnd2UpperParams,// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: é¢ï¼’æ–¹å‘ã®ä¸Šå´ç«¯éƒ¨ã®ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã®ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        WCS, // è¦ç´ ï¼š ãƒ–ãƒ©ã‚±ãƒƒãƒˆãŒä½¿ç”¨ã™ã‚‹åº§æ¨™ç³»ã‚’æŒ‡å®šã€‚é€šå¸¸ã¯æŒ‡å®šã—ãªã„
        ReferMethod, // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š
        
ã€‡èˆ¹æ®»ã®ãƒ–ãƒ©ã‚±ãƒƒãƒˆã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’ä½œæˆã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã—ãŸã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®ID
  CreateBracket(
ã€€ã€€    ParamObj, // ãƒ–ãƒ©ã‚±ãƒƒãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        bUpdate ); // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰
        

ã€‡èˆ¹æ®»ã®ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’ä½œæˆã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã—ãŸã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®ID
  CreatePlate(
        PlateName,     // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ElementGroup,  // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        MaterialName, // ææ–™ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®æè³ªåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        Plane,        // å¹³é¢ï¼š ãƒ—ãƒ¬ãƒ¼ãƒˆã®ã‚‹å¹³é¢ä½ç½®
        PlaneOffset,ã€€// é•·ã•ï¼šã€€å¹³é¢ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢ã‚’æŒ‡å®š
        Thickness,ã€€ã€€// é•·ã•ï¼š æ¿åš
        nMold,ã€€ã€€ã€€ã€€// ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®: 
        MoldOffset,  // é•·ã•ï¼š ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
        BoundSolid,ã€€// è¦ç´ ï¼šã€€ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰ã®å¢ƒç•Œã¨ãªã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã€‚
        Section1End1,ã€€// é•·ã•ï¼š ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰ã®å¹³é¢ä¸Šã®æ–¹å‘ï¼‘ã®å¢ƒç•Œä½ç½®ã®åº§æ¨™å€¤ï¼‘
        Section1End2,ã€€// é•·ã•ï¼š ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰ã®å¹³é¢ä¸Šã®æ–¹å‘ï¼‘ã®å¢ƒç•Œä½ç½®ã®åº§æ¨™å€¤ï¼’
        Section2End1,ã€€// é•·ã•ï¼š ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰ã®å¹³é¢ä¸Šã®æ–¹å‘ï¼’ã®å¢ƒç•Œä½ç½®ã®åº§æ¨™å€¤ï¼‘
        Section2End2,ã€€// é•·ã•ï¼š ãƒ—ãƒ¬ãƒ¼ãƒˆã‚½ãƒªãƒƒãƒ‰ã®å¹³é¢ä¸Šã®æ–¹å‘ï¼’ã®å¢ƒç•Œä½ç½®ã®åº§æ¨™å€¤ï¼’
        bUpdate ); // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡èˆ¹æ®»ã®æ¡æã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
  è¿”ã‚Šå€¤:æ¡æè¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
  CreateProfileParam()

ã€‡æ¡æè¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
   å±æ€§
        DefinitionType //ã€€æ•´æ•°: ã®ä½œæˆæ–¹æ³•æŒ‡å®šã€€0:å–ä»˜ç·šæŒ‡å®š ã€€1:åŸºæº–é¢æŒ‡å®š  2:å–ä»˜ç·šï¼‹æŒ‡å®šæ–¹å‘ç·š  3: å…ƒè¦ç´ æŒ‡å®š
ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ã€€ // 4:ãƒ›ãƒ¼ãƒ«æŒ‡å®š  5:ï¼’ç‚¹  6:ãƒ­ãƒ³ã‚¸é–“  7:åŸºæº–ç·šæŒ‡å®š  8:åŸºæº–ç‚¹ã¨æ–¹å‘  9:åŸºæº–è¦ç´ 
        ProfileName // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹æ¡æã‚½ãƒªãƒƒãƒ‰è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ElementGroup // è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        MaterialName // ææ–™ï¼šä½œæˆã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®æè³ªåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        FlangeName // æ–‡å­—åˆ—ï¼šãƒ“ãƒ«ãƒˆã‚¢ãƒƒãƒ—ã‚’ä½œæˆã™ã‚‹å ´åˆã®ãƒ•ãƒ©ãƒ³ã‚¸ã‚½ãƒªãƒƒãƒ‰è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        FlangeElementGroup// è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ï¼šãƒ•ãƒ©ãƒ³ã‚¸ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Œã‚‹å ´åˆã¯è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡å®šï¼ˆç©ºæ–‡å­—å¯ï¼‰
        FlangeMaterialName// ææ–™ï¼šä½œæˆã™ã‚‹ãƒ•ãƒ©ãƒ³ã‚¸ã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®æè³ªåç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
        ProfileType    // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: æ¡æã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®š
        ProfileParam // å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: æ¡æã®å½¢çŠ¶ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        FaceAngle // è§’åº¦ï¼š ãƒ“ãƒ«ãƒˆã‚¢ãƒƒãƒ—ã‚’ä½œæˆã™ã‚‹å ´åˆã®ãƒ•ãƒ©ãƒ³ã‚¸ã®è§’åº¦æŒ‡å®šã€€ï¼Â°ã¯ç›´è§’ã‚’æ„å‘³ã—ã€ãã“ã‹ã‚‰ã®å¢—åˆ†ã‚’ï¼‹ï¼ã§æŒ‡å®š
        ConnectionTol // é•·ã•ï¼š å–ä»˜ç·šãŒè¤‡æ•°ã®å ´åˆã®é€£ç¶šæ€§ã®åˆ¤å®šãƒˆãƒ¬ãƒ©ãƒ³ã‚¹ã‚’æŒ‡å®šï¼ˆé€šå¸¸ã¯æŒ‡å®šã—ãªã„ã€ç©ºæ–‡å­—ï¼‰
        Mold      // ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®: 
        MoldOffset // é•·ã•ï¼š ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢
        ReverseDir // boolï¼šå–ä»˜æ–¹å‘ã‚’åè»¢ã™ã‚‹æ™‚True
        ReverseAngle // boolï¼šã‚¢ãƒ³ã‚°ãƒ«æ–¹å‘ã‚’åè»¢ã™ã‚‹æ™‚True
        BaseOnAttachLines // boolï¼š å–ä»˜ç·šã®å¢ƒç•Œã‚’åŸºæº–ã«ã™ã‚‹æ™‚True
        CalcSnipOnlyAttachLines // boolï¼šç«¯éƒ¨ã‚¹ãƒ‹ãƒƒãƒ—é‡ã‚’å–ä»˜ç·šã®ã¿ã§è¨ˆç®—ã™ã‚‹æ™‚True
        NotProfjectAttachLines // boolï¼šå–ä»˜ç·šã‚’å–ä»˜é¢ã«æŠ•å½±ã—ãªã„æ™‚True
        ProjectionDir // æ–¹å‘ï¼šå–ä»˜ç·šã‚’æŠ•å½±ã™ã‚‹å ´åˆã«è¨­å®šã€‚é€šå¸¸ã¯è¨­å®šã—ãªã„ï¼ˆç©ºç™½æ–‡å­—ï¼‰
        AttachDirMethod // æ•´æ•°:ã€€æ¡æå–ä»˜æ–¹å‘è¨­å®šã€€0: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã€€1:åŸºæº–å¹³é¢å†…ã€€2:å–ä»˜è§’åº¦æŒ‡å®š
        AttachAngle // è§’åº¦ï¼š å–ä»˜è§’åº¦æŒ‡å®š
        AttachDirection // æ–¹å‘ï¼šæ¡æå–ä»˜æ–¹å‘ ã‚’æŒ‡å®šã™ã‚‹å ´åˆã«è¨­å®šã™ã‚‹
        DefAnglePositionAxisDirã€€// æ–¹å‘ï¼šã­ã˜ã‚ŒãŸæ¡æã‚’ä½œæˆã™ã‚‹å ´åˆã®ãã®ãƒã‚¸ãƒ¬è§’åº¦ã‚’å®šç¾©ã™ã‚‹è»¸æ–¹å‘ã‚’æŒ‡å®šã€‚
        DefAngleBaseDirã€€// æ–¹å‘ï¼šã­ã˜ã‚ŒãŸæ¡æã‚’ä½œæˆã™ã‚‹å ´åˆã®ãã®ãƒã‚¸ãƒ¬è§’åº¦ã®åŸºæº–ã¨ãªã‚‹è»¸æ–¹å‘ã‚’æŒ‡å®šã€‚
        CCWDefAngle,ã€€// boolï¼šã€€ã­ã˜ã‚ŒãŸæ¡æã‚’ä½œæˆã™ã‚‹å ´åˆã®ãƒã‚¸ãƒ¬è§’åº¦ã‚’åçµ±è¨ˆã¾ã‚ã‚Šã«æŒ‡å®šã™ã‚‹å ´åˆã¯True
        DefPossitionAngles // ä½ç½®ã¨è§’åº¦é…åˆ—: ã­ã˜ã‚ŒãŸæ¡æã‚’ä½œæˆã™ã‚‹å ´åˆã®ãƒã‚¸ãƒ¬è§’åº¦ã‚’ä½ç½®ã¨è§’åº¦ã§æŒ‡å®š
        DefPositionNormalAngles // ä½ç½®ã¨è§’åº¦é…åˆ—:ã­ã˜ã‚ŒãŸæ¡æã‚’ä½œæˆã™ã‚‹å ´åˆã®ãƒã‚¸ãƒ¬è§’åº¦ã‚’ä½ç½®ã¨è§’åº¦ã‚’å–ä»˜é¢ã®æ³•ç·šä½ç½®ã‹ã‚‰ã®å·®åˆ†ã§æŒ‡å®š
        End1Elements  // è¦ç´ (é…åˆ—)ï¼š ç«¯éƒ¨ï¼‘ã€ç«¯éƒ¨ã¨ãªã‚‹è¦ç´ ã‚’æŒ‡å®šã™ã‚‹
        End1Type       // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ç«¯éƒ¨ï¼‘ã€æ¡æã®ç«¯éƒ¨ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®š
        End1TypeParams // å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ç«¯éƒ¨ï¼‘ã€æ¡æã®ç«¯éƒ¨ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        End2Elements   // è¦ç´ (é…åˆ—)ï¼š ç«¯éƒ¨ï¼’ã€ç«¯éƒ¨ã¨ãªã‚‹è¦ç´ ã‚’æŒ‡å®šã™ã‚‹
        End2Type       // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ç«¯éƒ¨ï¼’ã€æ¡æã®ç«¯éƒ¨ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®š
        End2TypeParams // å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ç«¯éƒ¨ï¼’ã€æ¡æã®ç«¯éƒ¨ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        End1ScallopType      // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ç«¯éƒ¨ï¼‘ã€æ¡æã®ç«¯éƒ¨ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®š
        End1ScallopTypeParams// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ç«¯éƒ¨ï¼‘ã€æ¡æã®ç«¯éƒ¨ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        End2ScallopType      // å½¢çŠ¶ã‚¿ã‚¤ãƒ—: ç«¯éƒ¨ï¼’ã€æ¡æã®ç«¯éƒ¨ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã‚¿ã‚¤ãƒ—ã‚’æŒ‡å®š
        End2ScallopTypeParams// å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿: ç«¯éƒ¨ï¼’ã€æ¡æã®ç«¯éƒ¨ã‚¹ã‚«ãƒ©ãƒƒãƒ—ã‚¿ã‚¤ãƒ—ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
        AttachLines // è¦ç´ (é…åˆ—)ï¼šæ¡æã®å–ä»˜ç·š 
        AttachSurfaceã€€// è¦ç´ (é…åˆ—)ï¼šæ¡æã‚’å–ã‚Šä»˜ã‘ã‚‹é¢è¦ç´ ï¼ˆãƒ•ã‚§ã‚¤ã‚¹ã€ã‚·ãƒ¼ãƒˆãƒœãƒ‡ã‚£ï¼‰
        BasePlaneã€€// è¦ç´ ï¼šåŸºæº–é¢è¦ç´ ï¼ˆå¹³é¢ã€ã‚·ãƒ¼ãƒˆã€ãƒ•ã‚§ã‚¤ã‚¹ï¼‰ã‚’æŒ‡å®š
        BasePlaneOffset // é•·ã•ï¼š åŸºæº–é¢ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆè·é›¢ã‚’æŒ‡å®š
        BaseSolidã€€// è¦ç´ ï¼šåŸºæº–è¦ç´ ï¼ˆã‚½ãƒªãƒƒãƒ‰ï¼‰ã‚’æŒ‡å®š
        PathCurves // è¦ç´ (é…åˆ—)ï¼šå–ä»˜ç·šï¼ˆå–ä»˜ç·šï¼‹æŒ‡å®šæ–¹å‘ç·šã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        DirLinesã€€ã€€// è¦ç´ (é…åˆ—)ï¼šåŸºæº–ç›´ç·šï¼ˆå–ä»˜ç·šï¼‹æŒ‡å®šæ–¹å‘ç·šã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        OrignalProfile // è¦ç´ ï¼š ä½œæˆå…ƒã®æ¡æ(å…ƒè¦ç´ æŒ‡å®šã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        HoleFeature  // è¦ç´ ï¼š ãƒ›ãƒ¼ãƒ«ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼(ãƒ›ãƒ¼ãƒ«æŒ‡å®šã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        LocationAtHole //æ•´æ•°: æ¡æã®ä½ç½®ã€€0:ä¸Š 1:ä¸‹ 2:å·¦ 3:å³ã€€(ãƒ›ãƒ¼ãƒ«æŒ‡å®šã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BasePoint1 // ç‚¹: åŸºæº–ç‚¹1 (ï¼’ç‚¹ã‚‚ã—ãã¯åŸºæº–ç‚¹ã¨æ–¹å‘ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BasePoint2 // ç‚¹: åŸºæº–ç‚¹2 (ï¼’ç‚¹ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BaseProfile1 // è¦ç´ ï¼š ãƒ­ãƒ³ã‚¸ï¼‘(ãƒ­ãƒ³ã‚¸é–“ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BaseProfile2 // è¦ç´ ï¼š ãƒ­ãƒ³ã‚¸ï¼’(ãƒ­ãƒ³ã‚¸é–“ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BaseDirection1 // æ–¹å‘ï¼š (åŸºæº–ç‚¹ã¨æ–¹å‘ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BaseDirection2 // æ–¹å‘ï¼š å–ä»˜æ–¹å‘æŒ‡å®šã€€(åŸºæº–ç‚¹ã¨æ–¹å‘ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        BaseLocation //æ•´æ•°:  åŸºæº–ä½ç½® 0:å·¦ä¸‹ 1:ä¸­ä¸‹ 2:å³ä¸‹ 3:å·¦ä¸­ 4:ä¸­ä¸­ 5:å³ä¸­ 6:å·¦ä¸Š 7:ä¸­ä¸Š 8:å³ä¸Š (åŸºæº–ç‚¹ã¨æ–¹å‘ã§ä½œæˆã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹)
        ReferMethod // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š

ã€‡èˆ¹æ®»ã®æ¡æã‚½ãƒªãƒƒãƒ‰è¦ç´ ã‚’å–ä»˜ç·šæŒ‡å®šã§ä½œæˆã™ã‚‹
  è¿”ã‚Šå€¤:ä½œæˆã—ãŸæ¡æã‚½ãƒªãƒƒãƒ‰è¦ç´ ã®ID(é…åˆ—ã€€é…åˆ—[0]Webè¦ç´  é…åˆ—[1]ãƒ•ãƒ©ãƒ³ã‚¸è¦ç´ 
  CreateProfile(
ã€€ã€€    ParamObj, // æ¡æè¦ç´ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        bUpdate );  // boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ãƒœãƒ‡ã‚£ã‚’æŒ‡å®šã—ãŸè¦ç´ ã§åˆ†å‰²ã™ã‚‹
  è¿”ã‚Šå€¤:åˆ†å‰²ã§ä½œæˆã•ã‚ŒãŸãƒœãƒ‡ã‚£è¦ç´ ã®IDé…åˆ—
BodyDivideByElements(
    pDriveFeatureName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹åˆ†å‰²ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
    pTargetBody,// è¦ç´ : åˆ†å‰²å¯¾è±¡ã®ãƒœãƒ‡ã‚£
    pDivideElements,  // è¦ç´ (é…åˆ—): åˆ†å‰²ã‚’ã™ã‚‹è¦ç´ ï¼ˆã‚·ãƒ¼ãƒˆãƒœãƒ‡ã‚£ã€ãƒ•ã‚§ã‚¤ã‚¹ã€å¹³é¢è¦ç´ ï¼‰
    pAlignmentDirection,ã€€// æ–¹å‘ï¼š åˆ†å‰²ã•ã‚ŒãŸãƒœãƒ‡ã‚£è¦ç´ ã®é †ç•ªã‚’æ•´åˆ—ã•ã›ã‚‹ã®ã«ä½¿ç”¨ã™ã‚‹æ–¹å‘
    pWCS, // è¦ç´ ï¼š æ–¹å‘ã‚’å®šç¾©ã™ã‚‹åº§æ¨™ç³»ï¼ˆé€šå¸¸ã¯æŒ‡å®šã—ãªã„ï¼‰
    ReferMethod, // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š
     bUpdate);ã€€// boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡ãƒœãƒ‡ã‚£ã‚’æŒ‡å®šã—ãŸã‚½ãƒªãƒƒãƒ‰ã§å‰Šé™¤ã™ã‚‹ã“ã¨ã§åˆ†å‰²ã™ã‚‹ï¼ˆãƒœãƒ‡ã‚£ã®åŒºåˆ†ã‘ã‚³ãƒãƒ³ãƒ‰ï¼‰
  è¿”ã‚Šå€¤:åˆ†å‰²ã§ä½œæˆã•ã‚ŒãŸãƒœãƒ‡ã‚£è¦ç´ ã®IDé…åˆ—
ã€€BodySeparateBySubSolids(
    pSeparateFeatureName, // æ–‡å­—åˆ—ï¼šä½œæˆã™ã‚‹åˆ†å‰²ãƒ•ã‚£ãƒ¼ãƒãƒ£ãƒ¼è¦ç´ åç§°ï¼ˆç©ºæ–‡å­—å¯ï¼‰
    pTargetBody, // è¦ç´ : åˆ†å‰²å¯¾è±¡ã®ãƒœãƒ‡ã‚£
    pSubSolids, // è¦ç´ (é…åˆ—): åˆ†å‰²ã‚’ã™ã‚‹ã‚½ãƒªãƒƒãƒ‰è¦ç´ 
    pAlignmentDirection,ã€€// æ–¹å‘ï¼š åˆ†å‰²ã•ã‚ŒãŸãƒœãƒ‡ã‚£è¦ç´ ã®é †ç•ªã‚’æ•´åˆ—ã•ã›ã‚‹ã®ã«ä½¿ç”¨ã™ã‚‹æ–¹å‘
    ReferMethod, // é–¢é€£è¨­å®š: è¦ç´ ã®é–¢é€£ã¥ã‘æ–¹æ³•ã®æŒ‡å®š
    bUpdate);ã€€// boolï¼šæ›´æ–°ãƒ•ãƒ©ã‚°ï¼ˆæœªå®Ÿè£…ã€ä½¿ç”¨ã—ãªã„ï¼‰

ã€‡æŒ‡å®šè¦ç´ ã®è‰²ã‚’è¨­å®šã™ã‚‹
  SetElementColor(
     Element  // è¦ç´ ï¼šè‰²ã‚’è¨­å®šã™ã‚‹è¦ç´ 
     RValue,  // æ•´æ•°: èµ¤è‰²ã®å€¤(0-255)
     GValue,  // æ•´æ•°: ç·‘è‰²ã®å€¤(0-255)
     BValue,  // æ•´æ•°: é’è‰²ã®å€¤(0-255)
     Transparency ) // æµ®å‹•å°æ•°ç‚¹: é€æ˜åº¦ã®æŒ‡å®š(0.0ä¸é€æ˜-1.0é€æ˜)"""
        return DEFAULT_API_DOC
    
    return read_file_safely(file_path)

def load_prompt(file_path=None):
    """
    ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€é–¢æ•°
    
    Args:
        file_path (str): ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
        
    Returns:
        str: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹
        
    Raises:
        FileNotFoundError: æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
        UnicodeDecodeError: ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒä¸æ­£ãªå ´åˆ
        IOError: ãã®ä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼
    """
    if file_path is None:
        DEFAULT_PROMPT = """ã‚ãªãŸã¯å„ªç§€ãªAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè§£æã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰æä¾›ã•ã‚ŒãŸæ—¥æœ¬èªã®APIä»•æ§˜æ›¸ï¼ˆè‡ªç„¶è¨€èªï¼‰ã‚’å³å¯†ã«è§£æã—ã€æŒ‡å®šã®JSONå½¢å¼ã®ã¿ã‚’å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚

å³å®ˆäº‹é …:
- å‡ºåŠ›ã¯æœ‰åŠ¹ãªJSONé…åˆ—ã®ã¿ã€‚Markdownã‚„ä½™åˆ†ãªãƒ†ã‚­ã‚¹ãƒˆã¯ç¦æ­¢ã€‚
- æ¨æ¸¬ã‚„è£œå®Œã¯é¿ã‘ã€ä¸ãˆã‚‰ã‚ŒãŸæœ¬æ–‡ã‹ã‚‰æ ¹æ‹ ãŒã‚ã‚‹ã‚‚ã®ã®ã¿æŠ½å‡ºã€‚
- å‹åã¯ä»¥ä¸‹ã®æ—¥æœ¬èªè¡¨è¨˜ã®ã„ãšã‚Œã‹ã«æ­£è¦åŒ–ã—ã¦ä½¿ç”¨ï¼ˆå³å¯†ä¸€è‡´ï¼‰:
  ["æ–‡å­—åˆ—","æµ®å‹•å°æ•°ç‚¹","æ•´æ•°","bool","é•·ã•","è§’åº¦","æ–¹å‘","æ–¹å‘(2D)","è¦ç´ ","è¦ç´ (é…åˆ—)","è¦ç´ ID","è¦ç´ ID(é…åˆ—)","è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—","ææ–™","å¹³é¢","ç‚¹","ç‚¹(2D)","æ³¨è¨˜ã‚¹ã‚¿ã‚¤ãƒ«","ã‚ªãƒšãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ—","åšã¿ä»˜ã‘ã‚¿ã‚¤ãƒ—","é–¢é€£è¨­å®š","å½¢çŠ¶ã‚¿ã‚¤ãƒ—","å½¢çŠ¶ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿","ãƒ¢ãƒ¼ãƒ«ãƒ‰ä½ç½®","ã‚¹ã‚¤ãƒ¼ãƒ—æ–¹å‘","å‹¾é…ï¼’ã®ã‚¿ã‚¤ãƒ—","ä½ç½®ã¨è§’åº¦é…åˆ—","ç¯„å›²","åº§æ¨™ç³»","BSTR","å¤‰æ•°å˜ä½","æµ®å‹•å°æ•°ç‚¹(é…åˆ—)"]
- é…åˆ—å‹ã¯ã€ŒX(é…åˆ—)ã€ã®è¡¨è¨˜ã‚’å„ªå…ˆã€‚å¯èƒ½ãªã‚‰é…åˆ—è¦ç´ å‹ã‚’array_info.element_typeã«è¨­å®šã€‚
- ã€Œç©ºæ–‡å­—ä¸å¯ã€ã¯å¿…é ˆã€‚èª¬æ˜ã«ï¼ˆç©ºæ–‡å­—å¯ï¼‰ãŒã‚ã‚Œã°ä»»æ„ã€‚
- ä¸æ˜ãªå‹ã‚„èª¬æ˜ã¯notesã«ã€Œä¸æ˜ã€ã‚„æ ¹æ‹ ä»˜ãã§è¨˜è¼‰ã—ã€å‹ã¯æœ€ã‚‚å¦¥å½“ãªå€™è£œã«æƒãˆã‚‹ã€‚

è§£æã®è¦³ç‚¹:
1. é–¢æ•°åãƒ»èª¬æ˜ãƒ»ã‚«ãƒ†ã‚´ãƒªï¼ˆè¦‹å‡ºã—ã‚„æœ¬æ–‡ã‹ã‚‰ï¼‰
2. ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åãƒ»å‹ãƒ»èª¬æ˜ãƒ»å¿…é ˆæ€§ãƒ»é…åˆ—/ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆè©³ç´°
3. æˆ»ã‚Šå€¤ï¼ˆå‹ãƒ»èª¬æ˜ãƒ»é…åˆ—æ§‹é€ ï¼‰
4. å®Ÿè£…çŠ¶æ³ï¼ˆã€Œæœªå®Ÿè£…ã€ã€Œä½¿ç”¨ã—ãªã„ã€ã®è¨˜è¿°ã¯å³å¯†ã«åæ˜ ï¼‰
5. ä¾å­˜é–¢ä¿‚ï¼ˆå‰æè¦ç´ ã‚„å¿…è¦è¨­å®šãŒæœ¬æ–‡ã«ã‚ã‚‹å ´åˆã®ã¿ï¼‰

å‡ºåŠ›ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ:
{json_format}

è§£æå¯¾è±¡:
---
{document}
---"""
        return DEFAULT_PROMPT
    return read_file_safely(file_path)

def load_json_format_instructions(file_path=None):
    if file_path is None:
        DEFAULT_JSON_FORMAT_INSTRUCTIONS = """
        [
            {
    "name": "string",
    "type": "function",
    "category": "string",
    "description": "string",
    "params": [
      {
        "name": "string",
        "type_name": "string",
        "description_raw": "string",
        "constraints": ["string"],
        "summary_llm": "string | null",
        "constraints_llm": ["string"],
        "is_required": "boolean",
        "default_value": "string | null",
        "array_info": {
          "is_array": "boolean",
          "element_type": "string",
          "min_length": "number | null",
          "max_length": "number | null"
        } | null,
        "object_info": {
          "is_object": "boolean",
          "object_type": "string",
          "properties": ["string"]
                        } | null,
        "position": "number"
      }
    ],
    "returns": {
      "type_name": "string",
      "description": "string",
      "is_array": "boolean",
      "array_structure": "string | null"
    },
    "notes": "string | null",
    "implementation_status": "string",
    "complexity_level": "string",
    "dependencies": ["string"],
    "signature_raw": "string | null"
            }
        ]
        """
        return DEFAULT_JSON_FORMAT_INSTRUCTIONS
    return read_file_safely(file_path)

def write_file_safely(file_path, content, encoding="utf-8"):
    """
    ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®‰å…¨ã«æ›¸ãè¾¼ã‚€å…±é€šé–¢æ•°
    
    Args:
        file_path (str): æ›¸ãè¾¼ã‚€ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹
        content (str): æ›¸ãè¾¼ã‚€å†…å®¹
        encoding (str): ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: utf-8ï¼‰
        
    Raises:
        IOError: ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿ã‚¨ãƒ©ãƒ¼
        PermissionError: ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ãŒãªã„å ´åˆ
    """
    try:
        # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
        import os
        os.makedirs(os.path.dirname(file_path), exist_ok=True)
        
        with open(file_path, "w", encoding=encoding) as file:
            file.write(content)
    except PermissionError:
        raise PermissionError(f"ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“: {file_path}")
    except IOError as e:
        raise IOError(f"ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿ã‚¨ãƒ©ãƒ¼: {file_path} - {str(e)}")

def save_parsed_result(parsed_result, output_file_path="doc_paser/parsed_api_result.json"):
    """
    è§£æçµæœã‚’JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ä¿å­˜ã™ã‚‹é–¢æ•°
    
    Args:
        parsed_result (dict or list): ä¿å­˜ã™ã‚‹è§£æçµæœï¼ˆè¾æ›¸ã¾ãŸã¯ãƒªã‚¹ãƒˆï¼‰
        output_file_path (str): å‡ºåŠ›ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: parsed_api_result.jsonï¼‰
        
    Raises:
        IOError: ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿ã‚¨ãƒ©ãƒ¼
        PermissionError: ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®æ›¸ãè¾¼ã¿æ¨©é™ãŒãªã„å ´åˆ
    """
    import json
    
    try:
        # è§£æçµæœã‚’JSONå½¢å¼ã§æ•´å½¢
        json_content = json.dumps(parsed_result, ensure_ascii=False, indent=2)
        
        # ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
        write_file_safely(output_file_path, json_content)
        
        print(f"è§£æçµæœã‚’ä¿å­˜ã—ã¾ã—ãŸ: {output_file_path}")
        
    except Exception as e:
        print(f"è§£æçµæœã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ: {str(e)}")
        raise

def normalize_type_name(type_name: str) -> str:
    if not isinstance(type_name, str):
        return type_name
    name = type_name.strip()
    mapping = {
        "string": "æ–‡å­—åˆ—",
        "str": "æ–‡å­—åˆ—",
        "float": "æµ®å‹•å°æ•°ç‚¹",
        "double": "æµ®å‹•å°æ•°ç‚¹",
        "number": "æµ®å‹•å°æ•°ç‚¹",
        "int": "æ•´æ•°",
        "integer": "æ•´æ•°",
        "boolean": "bool",
        "bool": "bool",
        "length": "é•·ã•",
        "angle": "è§’åº¦",
        "direction": "æ–¹å‘",
        "direction2d": "æ–¹å‘(2D)",
        "plane": "å¹³é¢",
        "point": "ç‚¹",
        "point2d": "ç‚¹(2D)",
        "element": "è¦ç´ ",
        "elementid": "è¦ç´ ID",
        "element group": "è¦ç´ ã‚°ãƒ«ãƒ¼ãƒ—",
        "material": "ææ–™",
        "style": "æ³¨è¨˜ã‚¹ã‚¿ã‚¤ãƒ«",
        "bstr": "BSTR",
        "é…åˆ—": "é…åˆ—",
        "æµ®å‹•å°æ•°ç‚¹(é…åˆ—)": "æµ®å‹•å°æ•°ç‚¹(é…åˆ—)",
    }
    key = name.lower().replace(" ", "")
    return mapping.get(key, name)


def enrich_array_object_info(param: dict) -> None:
    t = param.get("type_name")
    if not isinstance(t, str):
        return
    is_array = "(é…åˆ—)" in t or t.endswith("é…åˆ—") or t.endswith("(array)")
    if is_array:
        base = t.replace("(é…åˆ—)", "").replace("é…åˆ—", "").strip("ï¼š: ")
        element_type = base if base and base != "è¦ç´ " else None
        param["array_info"] = {
            "is_array": True,
            "element_type": element_type,
            "min_length": None,
            "max_length": None,
        }
    else:
        if param.get("array_info") is None:
            param["array_info"] = None


def infer_is_required(param: dict) -> None:
    cons = param.get("constraints") or []
    desc = param.get("description_raw") or ""
    text = " ".join(cons) + " " + desc
    required = ("ç©ºæ–‡å­—ä¸å¯" in text) or ("å¿…é ˆ" in text)
    if "ç©ºæ–‡å­—å¯" in text:
        required = False
    param["is_required"] = bool(required)


def postprocess_parsed_result(parsed_result):
    if not isinstance(parsed_result, list):
        return parsed_result
    for fn in parsed_result:
        if isinstance(fn.get("returns"), dict):
            r_t = fn["returns"].get("type_name")
            if r_t is not None:
                fn["returns"]["type_name"] = normalize_type_name(r_t)
        params = fn.get("params") or []
        for idx, p in enumerate(params):
            t = p.get("type_name")
            if t is not None:
                p["type_name"] = normalize_type_name(t)
            enrich_array_object_info(p)
            infer_is_required(p)
            p["position"] = idx
        fn["params"] = params
    return parsed_result

def main():
    # è§£æå¯¾è±¡ã®è‡ªç„¶è¨€èªAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
    api_document_text = load_api_document("data/src/api 1.txt")
    # LLMã¸ã®æŒ‡ç¤ºã‚’ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆåŒ–ã™ã‚‹
    prompt = ChatPromptTemplate.from_template(load_prompt())
    # LLMã«ç”Ÿæˆã—ã¦ã»ã—ã„JSONã®å½¢å¼ã‚’å®šç¾©ã™ã‚‹
    json_format_instructions = load_json_format_instructions()
    # JSONå‡ºåŠ›ã‚’å°‚é–€ã«è¡Œã†ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’æº–å‚™
    parser = JsonOutputParser()

    try:
        # LLMãƒ¢ãƒ‡ãƒ«ã‚’åˆæœŸåŒ– (ç’°å¢ƒå¤‰æ•°ã‹ã‚‰APIã‚­ãƒ¼ã‚’è‡ªå‹•èª­ã¿è¾¼ã¿)
        llm = ChatOpenAI(model="gpt-5-nano")

        # ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã€LLMã€å‡ºåŠ›ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’ `|` ã§é€£çµã—ã¦ãƒã‚§ãƒ¼ãƒ³ã‚’ä½œæˆ (LCELæ§‹æ–‡)
        chain = prompt | llm | parser

        print("ğŸ¤– LLMã‚’ä½¿ã£ã¦APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è§£æã—ã¦ã„ã¾ã™...")

        # ãƒã‚§ãƒ¼ãƒ³ã‚’å®Ÿè¡Œã—ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨å‡ºåŠ›å½¢å¼ã‚’æ¸¡ã™
        parsed_result = chain.invoke({
            "document": api_document_text,
            "json_format": json_format_instructions
        })

        # å‡ºåŠ›ã®å¾Œå‡¦ç†ï¼ˆå‹åã®æ­£è¦åŒ–ãƒ»è£œå®Œï¼‰
        parsed_result = postprocess_parsed_result(parsed_result)

        # --- 5. çµæœã®è¡¨ç¤º ---
        print("\nâœ… è§£æãŒå®Œäº†ã—ã€JSONã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚")
        # Pythonã®è¾æ›¸ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦æ•´å½¢ã—ã¦è¡¨ç¤º
        print(json.dumps(parsed_result, indent=2, ensure_ascii=False))

        print("\n---")
        # Pythonã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã“ã¨ã‚’ç¢ºèª
        # parsed_resultã¯ãƒªã‚¹ãƒˆãªã®ã§ã€æœ€åˆã®è¦ç´ ã‚’å–å¾—
        if isinstance(parsed_result, list) and len(parsed_result) > 0:
            first_api = parsed_result[0]
            print(f"APIå: {first_api.get('name')}")
            print(f"ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿æ•°: {len(first_api.get('params', []))}")
            print(f"æˆ»ã‚Šå€¤ã®å‹: {first_api.get('returns', {}).get('type_name', 'N/A')}")
        else:
            print("è§£æçµæœãŒç©ºã¾ãŸã¯äºˆæœŸã—ãªã„å½¢å¼ã§ã™")

        # è§£æçµæœã‚’ä¿å­˜
        save_parsed_result(parsed_result)


    except Exception as e:
        print(f"\nâŒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}")
        print(f"ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡: {type(e).__name__}")
        
        # ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã‚’è¿½åŠ 
        if 'parsed_result' in locals():
            print(f"parsed_resultã®å‹: {type(parsed_result)}")
            if isinstance(parsed_result, list):
                print(f"parsed_resultã®é•·ã•: {len(parsed_result)}")
                if len(parsed_result) > 0:
                    print(f"æœ€åˆã®è¦ç´ ã®å‹: {type(parsed_result[0])}")
        
        if "api_key" in str(e).lower():
            print("\nğŸ’¡ ãƒ’ãƒ³ãƒˆ: .envãƒ•ã‚¡ã‚¤ãƒ«ã«æ­£ã—ã„OPENAI_API_KEYãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚")
        elif "list" in str(e).lower() and "get" in str(e).lower():
            print("\nğŸ’¡ ãƒ’ãƒ³ãƒˆ: è§£æçµæœãŒãƒªã‚¹ãƒˆå½¢å¼ã§è¿”ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€é©åˆ‡ãªã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚¢ã‚¯ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚")

        pass
if __name__ == "__main__":
    project_root = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
    if project_root not in sys.path:
        sys.path.insert(0, project_root)

    print(f"ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹: {project_root}")
    print(f"Pythonãƒ‘ã‚¹ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸ: {project_root in sys.path}")
    
    main()
